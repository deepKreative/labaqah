<ion-header mode='ios'>
  <ion-toolbar class="ion-no-padding">
    <ion-buttons slot="start">
      <ion-back-button  text=""  defaultHref="/tabs/categories" style="padding-left: 5px;padding-right: 5px;"></ion-back-button>
    </ion-buttons>
    <ion-title><h3 style="margin: 0;">{{getCatName}}</h3></ion-title>
      <!-- <ion-searchbar mode="ios" animated *ngIf="showSearch" [(ngModel)]="searchInput" (ionChange)="onInput()" placeholder="{{'Search' | translate}}"></ion-searchbar> -->
    <ion-buttons slot="end" (click)="getFilter()"><ion-icon name="funnel-outline" style="font-size: 23px ;padding-left: 5px;padding-right: 5px;" ></ion-icon></ion-buttons>
    <ion-buttons slot="end" (click)="toggleGridView()"><!--ion-icon name="{{gridView ? 'menu' : 'grid' }}" style="margin: 0 8px;font-size: 23px"></ion-icon--></ion-buttons>
    
  </ion-toolbar>
</ion-header>

<ion-content >
<!-- <img src="{{vendor.banner}}"> -->




  <div *ngIf="subCategories.length" class="scrollmenu2">
    <div *ngFor="let item of subCategories" class="scroll ion-activatable ion-focusable hydrated" (click)="getCategory(item.id)">
      <img alt="" *ngIf="item.image?.src" src="{{item.image.src}}" [style.border-radius.px]="settings.dimensions.suCatBorderRadius">
      <h5><span [innerHTML]="item.name"></span></h5>
    </div>
  </div>

  
  <div class="spinner" *ngIf="loader "><ion-spinner> </ion-spinner></div>
  <div class="spinner" *ngIf="!loader && products.length == 0">{{"No Results" | translate}}</div>

  <!-- GRID VIEW --> 
<div *ngIf="products && gridView">

<ion-row *ngIf="products?.length" class="products">
  <ion-row class="align-content: center;" class="card-banner"  >


    <ion-card class="ion-no-padding" style="border-radius: 0px 0px 15px 15px ;"    >
      <ion-img src="{{getCat}}" style="width: 100%"></ion-img>
      <ion-card-header>
        <ion-card-title> 
          <!-- <ion-grid>
            <ion-row>
              <ion-col size="8">
                <h3 style="margin: 0px;">{{getCatName}}</h3>
              </ion-col>
              <ion-col size="4">
                <ion-row *ngIf="countTotalPercentage >= 5">
                  <ion-col size="4">
                    <span class="review-stars"><span class="rating review-star" style="float:none">
                    <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span></span></span>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="countTotalPercentage < 5  && countTotalPercentage >= 4 ">
                  <ion-col size="4">
                    <span class="review-stars"><span class="rating review-star" style="float:none">
                    <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon ">&#x2605;</span></span></span>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="countTotalPercentage < 4  && countTotalPercentage >= 3 ">
                  <ion-col size="4">
                    <span class="review-stars"><span class="rating review-star" style="float:none">
                    <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon  ">&#x2605;</span> <span class="star-icon ">&#x2605;</span></span></span>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="countTotalPercentage < 3  && countTotalPercentage >= 2 ">
                  <ion-col size="4">
                    <span class="review-stars"><span class="rating review-star" style="float:none">
                    <span class="star-icon full">&#x2605;</span> <span class="star-icon full">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span></span></span>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="countTotalPercentage < 2  && countTotalPercentage >= 1 ">
                  <ion-col size="4">
                    <span class="review-stars"><span class="rating review-star" style="float:none">
                    <span class="star-icon full">&#x2605;</span> <span class="star-icon">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span></span></span>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="countTotalPercentage < 1  && countTotalPercentage > 0 ">
                  <ion-col size="4">
                    <span class="review-stars"><span class="rating review-star" style="float:none">
                    <span class="star-icon full">&#x2605;</span> <span class="star-icon">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span></span></span>
                  </ion-col>
                </ion-row>
                <ion-row *ngIf="!countTotalPercentage">
                  <ion-col size="4">
                    <span class="review-stars"><span class="rating review-star" style="float:none">
                    <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span> <span class="star-icon ">&#x2605;</span></span></span>
                  </ion-col>
                </ion-row>
              </ion-col>
            </ion-row>
            <div *ngIf="countTotalPercentage"> -->
           
          <!-- </div>
          </ion-grid> -->
        </ion-card-title>
      </ion-card-header>
			<ion-grid >
				<ion-row>
					<ion-col  size="2" class="Alignert">
							<img src={{getCatIcon}} style="border-radius:50% ; width: 50px; border: 1px solid #CDCDCD;">
					</ion-col>
					<ion-col size="9" class="ion-no-padding" >
						<ion-label>
							<ion-row>
                {{vendor_disc}}
              </ion-row>
						</ion-label>
					</ion-col>
				</ion-row>
			</ion-grid>
		</ion-card>










    <!-- <ion-card  class="card-bannerc">
      <ion-img src="{{getCat}}" style="width: 410px"></ion-img>
      <ion-card-header>
        <ion-card-title> <h3 style="margin: 10;">{{getCatName}}</h3></ion-card-title>
      </ion-card-header>
      <ion-card-content *ngIf="vendor_disc">
        <ion-row style="padding: 20px;">
          <ion-col size="2">
            <ion-thumbnail>
              <img src="{{getCatIcon}}">
            </ion-thumbnail>
          </ion-col>
          <ion-col size="10" style="text-align: start;">
             {{vendor_disc}}
          </ion-col>
        </ion-row>
      </ion-card-content>
    </ion-card> -->
</ion-row>
    <ion-col size="{{settings.colWidthLatest}}" *ngFor="let item of products" [style.padding.px]="settings.dimensions.productPadding">
  
    <ion-card  mode="md" class="ion-activatable ion-focusable hydrated {{settings.settings.product_shadow}} {{data.cart[item.id] >= 1 ? 'borderline-card' : ''}}" [style.border-radius.px]="settings.dimensions.productBorderRadius">
      <ion-img alt="" [style.height.px]="settings.dimensions.homeGridViewHeight" *ngIf="item.images?.length" [src]="item.images[0].src" (click)="getProduct(item)"></ion-img>
      <ion-img alt="" [style.height.px]="settings.dimensions.homeGridViewHeight" *ngIf="!item.images?.length" src="assets/image/logo.png" (click)="getProduct(item)"></ion-img>
      <ion-icon name="heart-outline" mode="md" class="wishlist-button-grid" *ngIf="!settings.wishlist[item.id]" (click)="settings.addToWishlist(item.id)"></ion-icon>
      <ion-icon name="gift-outline" mode="md" class="var-button-grid" *ngIf="item.type =='variable'"></ion-icon>
      <ion-icon name="heart" color="{{settings.theme.button}}" mode="md" class="wishlist-button-grid" *ngIf="settings.wishlist[item.id]" (click)="settings.removeFromWishlist(item.id)"></ion-icon>
        <ion-button color="danger" class="stock" *ngIf="item.stock_status == 'outofstock'">{{"No Stock" | translate}}</ion-button>
        <div *ngIf="item.stock_status == 'instock'">
        <ion-button color="success" class="offer" *ngIf="((item.regular_price - item.price) /item.regular_price*100) >= 1">{{(item.regular_price - item.price) /item.regular_price*100 | number : '1.0-0'}}%</ion-button>
        </div>
      <ion-card-header >
        <ion-card-title style="color: #400082;" mode="md">{{item.name}}</ion-card-title>
        <ion-card-subtitle class="ion-no-padding" mode="md">{{item.vendor.name}}</ion-card-subtitle>
      </ion-card-header>
      <ion-card-content>
        <p class="price">
            <span class="regular-price" *ngIf="!item.sale_price" [innerHTML]="item.formated_price"></span>
            <span class="regular-price" *ngIf="item.sale_price"><span [innerHTML]="item.formated_sales_price"></span><del>&nbsp;<span class="special-price" [innerHTML]="item.formated_price"></span></del></span>
        </p>
        <ion-row class="ion-align-items-center ion-justify-content-center">

        <ion-col *ngIf="data.cart[item.id] == undefined || data.cart[item.id] == 0">
                <ion-button  expand="block" size="small" color="favorite" [disabled]="item.stock_status == 'outofstock'" (click)="addToCart(item)">
                  {{item.stock_status == 'outofstock' ? "No Stock" : "ADD"  | translate}}
                </ion-button>
        </ion-col>
            <ion-col style="text-align: center;" *ngIf="data.cart[item.id] >= 1" align-self-end>
          <ion-row>
            <ion-col>
                  <ion-button expand="block" size="small" color="favorite" (click)="deleteFromCart(item)">
                  <ion-icon slot="icon-only" name="remove-circle-outline"></ion-icon>
                  </ion-button>
            </ion-col>
            <ion-col>
                  <ion-button expand="full" fill="outline" color="favorite" *ngIf="data.cart[item.id] >= 1">{{data.cart[item.id]}}
                  </ion-button>
            </ion-col>
            <ion-col>
                  <ion-button expand="block"  size="small" color="favorite"  *ngIf="data.cart[item.id] >= 1" (click)="updateToCart(item)">
                  <ion-icon slot="icon-only" name="add-circle-outline"></ion-icon>
                  </ion-button>
            </ion-col>
          </ion-row>
        </ion-col>
        </ion-row>
      </ion-card-content>
    </ion-card>
    </ion-col>
</ion-row>
</div>
<!-- <ion-fab  shape="round"  vertical="bottom" horizontal="end" slot="fixed" activated >
  <button shape="round"  ion-fab  color="success" [disabled]="data.count < 0" >
    <ion-icon name="basket" mode="md" slot="start" size="large" ></ion-icon>
    <ion-badge  color="{{settings.theme.button}}" *ngIf="data.count != 0"  (click)="goToCart()">
      <span class="count">{{data.count}}</span>
    </ion-badge>
  </button>
</ion-fab> -->

<!-- <ion-fab style="color: #6A097D;" vertical="bottom" horizontal="end"  slot="fixed"  >
 
  <ion-fab-button color=6A097D >
    
    <ion-icon name="basket" class="ioniconcolor2"  *ngIf="data.count == 0"   ></ion-icon>
  </ion-fab-button>
</ion-fab> -->

   
<ion-fab  vertical="bottom" horizontal="end" slot="fixed" (click)="goToCart()">
 
  <ion-fab-button color="fab" class="ali_button" >
    <ion-icon src="assets/shopping-cart.svg"  ></ion-icon>
  </ion-fab-button >
  <ion-badge  color="favorite"  *ngIf="data.count != 0"  (click)="goToCart()">
   <span class="count">{{data.count}}</span>
 </ion-badge>
</ion-fab>
  <!-- END OF GRID VIEW -->

  <!-- LIST VIEW -->
  <!--ion-list style="padding-bottom: 0; padding-top: 0;" class="product-list3" *ngIf="products && !gridView">
  <ion-item *ngFor="let product of products" lines="none">
        <ion-thumbnail slot="start" (click)="getProduct(product)" class="ion-activatable ion-focusable hydrated">
            <img *ngIf="product.images?.length" src="{{product.images[0].src}}">
        </ion-thumbnail>
        <ion-grid class="details">
            <ion-row (click)="getProduct(product)">
                <ion-col>
                    <ion-label>
                        {{product.name}}
                    </ion-label>
                </ion-col>
            </ion-row>
            <ion-row (click)="getProduct(product)">
                <ion-col>
                    <p class="price">
                    <span class="regular-price" *ngIf="!product.sale_price" [innerHTML]="product.formated_price"></span>
                    <span class="regular-price" *ngIf="product.sale_price" [innerHTML]="product.formated_sales_price"></span>
                      <del><span *ngIf="product.sale_price" class="special-price" [innerHTML]="product.formated_price">{{product.formated_price}}</span></del>
                    <span class="percent-off" *ngIf="((product.regular_price - product.price) /product.regular_price*100) >= 1">{{(product.regular_price - product.price) /product.regular_price*100 | number : '1.0-0'}}% OFF
                    </span>
                    </p>
                </ion-col>
            </ion-row>
            <ion-row>
                <ion-col>
                    <ion-icon (click)="settings.addToWishlist(product.id)" *ngIf="!settings.wishlist[product.id]" class="wishlist-button-list" mode="md" name="heart-outline">
                    </ion-icon>
                    <ion-icon (click)="settings.removeFromWishlist(product.id)" *ngIf="settings.wishlist[product.id]" class="wishlist-button-list" color="{{settings.theme.button}}" mode="md" name="heart">
                    </ion-icon>
                </ion-col>
            <ion-row class="ion-align-items-end ion-justify-content-end" style="float: right;">
                <ion-col align-self-end *ngIf="data.cart[product.id] == undefined || data.cart[product.id] == 0">
                    <ion-button style="--border-radius: 4px;" size="small" fill="outline" color="{{settings.theme.button}}" [disabled]="product.stock_status == 'outofstock'" (click)="addToCart(product)">
                      {{product.stock_status == 'outofstock' ? "No Stock" : "ADD"  | translate}}
                    </ion-button>
                </ion-col>
                <ion-col *ngIf="data.cart[product.id] >= 1" align-self-end>
                    <ion-button style="--padding-end: 0; --padding-start: 0" fill="clear" (click)="deleteFromCart(product)">
                    <ion-icon slot="icon-only" color="{{settings.theme.button}}" name="remove-circle-outline"></ion-icon>
                    </ion-button>

                    <ion-button style="padding-left: 0; padding-right: 0; width: 30px;"color="{{settings.theme.button}}" fill="clear" *ngIf="data.cart[product.id] >= 1">{{data.cart[product.id]}}
                    </ion-button>
                    <ion-button style="--padding-end: 0; --padding-start: 0" size="small" fill="clear" color="{{settings.theme.button}}"  *ngIf="data.cart[product.id] >= 1" (click)="updateToCart(product)">
                    <ion-icon slot="icon-only" name="add-circle-outline"></ion-icon>
                    </ion-button>
                </ion-col>
            </ion-row>
            </ion-row >
        </ion-grid>
    </ion-item>
  </ion-list-->
  <!-- END OF LIST VIEW -->


  <!-- <ion-item slot="top">
    <ion-badge  color="{{settings.theme.button}}" *ngIf="data.count != 0">
      <ion-icon name="basket" size="large" mode="md" ></ion-icon>
      <span class="count">{{data.count}}</span>
    </ion-badge>
  </ion-item> -->
  <ion-infinite-scroll threshold="100px" *ngIf="hasMoreItems && products.length" (ionInfinite)="loadData($event)">
    <ion-infinite-scroll-content
      loadingSpinner="bubbles"
      loadingText="Loading more data...">
    </ion-infinite-scroll-content>
  </ion-infinite-scroll>
  
</ion-content>
